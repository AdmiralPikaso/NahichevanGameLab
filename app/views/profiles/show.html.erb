<div class="container">
  <div class="row">
    <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê -->
    <div class="col-md-4">
      <div class="card mb-4">
        <div class="card-body text-center">

          <% if @profile.avatar.attached? %>
            <%= image_tag @profile.avatar.variant(resize: "150x150"),
              class: "rounded-circle mb-3",
              style: "width:150px;height:150px;object-fit:cover;" %>
          <% else %>
            <div class="rounded-circle bg-secondary d-flex align-items-center justify-content-center mx-auto mb-3"
                 style="width:150px;height:150px;">
              <span class="text-white display-4"><%= @user.email[0].upcase %></span>
            </div>
          <% end %>

          <h4><%= @user.email %></h4>

          <div class="row mt-3">
            <div class="col-6">
              <strong><%= @collections_count %></strong>
              <div class="text-muted small">–ö–æ–ª–ª–µ–∫—Ü–∏–π</div>
            </div>
            <div class="col-6">
              <strong><%= @games_count %></strong>
              <div class="text-muted small">–ò–≥—Ä</div>
            </div>
          </div>

          <% if @user != current_user %>
            <div class="mt-3">
              <% case @friendship_status %>
              <% when :friends %>
                <span class="badge bg-success mb-2">–î—Ä—É–≥</span>
              <% when :request_sent %>
                <span class="badge bg-warning text-dark mb-2">–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞</span>
              <% when :request_received %>
                <span class="badge bg-info mb-2">–û–∂–∏–¥–∞–µ—Ç –æ—Ç–≤–µ—Ç–∞</span>
              <% else %>
                <%= link_to "–î–æ–±–∞–≤–∏—Ç—å –≤ –¥—Ä—É–∑—å—è",
                      friendships_path(friend_id: @user.id),
                      method: :post,
                      class: "btn btn-primary w-100" %>
              <% end %>
            </div>
          <% else %>
            <div class="mt-3">
              <%= link_to "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å", edit_my_profile_path,
                    class: "btn btn-info w-100 mb-2" %>
              <%= link_to "–ú–æ–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏", collections_path,
                    class: "btn btn-success w-100" %>
              <%= link_to "–ú–æ–∏ –¥—Ä—É–∑—å—è",
          friendships_path,
          class: "btn btn-primary w-100" %>
            </div>
          <% end %>

        </div>
      </div>
    </div>

    <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê -->
    <div class="col-md-8">

      <!-- –û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï -->
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="mb-0">–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h5>
        </div>
        <div class="card-body">
          <% if @profile.bio.present? %>
            <p class="lead"><%= @profile.bio %></p>
          <% else %>
            <p class="text-muted">
              <%= @user == current_user ?
                "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è" :
                "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥–æ–±–∞–≤–∏–ª –æ–ø–∏—Å–∞–Ω–∏–µ" %>
            </p>
          <% end %>
        </div>
      </div>

      <!-- –ö–û–õ–õ–ï–ö–¶–ò–ò -->
      <% if @can_view_collections %>
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="mb-0">–ö–æ–ª–ª–µ–∫—Ü–∏–∏</h5>
          </div>
          <div class="card-body">

            <% if @top_collections.any? %>
              <div class="row">
                <% @top_collections.each do |collection| %>
                  <div class="col-md-4 mb-3">
                    <div class="card h-100">
                      <div class="card-body">
                        <strong><%= collection.name %></strong><br>
                        <small class="text-muted">
                          –ò–≥—Ä: <%= collection.games_count %>
                        </small>
                      </div>
                      <div class="card-footer bg-transparent">
                        <%= link_to "–û—Ç–∫—Ä—ã—Ç—å",
                              collection_path(collection),
                              class: "btn btn-sm btn-outline-primary w-100" %>
                      </div>
                    </div>
                  </div>
                <% end %>
              </div>
            <% else %>
              <p class="text-muted text-center">–ö–æ–ª–ª–µ–∫—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
            <% end %>

          </div>
        </div>
      <% else %>
        <div class="card">
          <div class="card-body text-muted text-center">
            üîí –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
          </div>
        </div>
      <% end %>

    </div>
  </div>
</div>
